<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Reclamo de Garantías</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 900px;
            margin: auto;
            background: white;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1, h2 {
            text-align: center;
            color: #006400; /* John Deere green */
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            padding: 8px;
            border: 1px solid #ddd;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .btn {
            display: inline-block;
            padding: 10px 20px;
            margin: 10px 5px;
            color: white;
            background-color: #006400;
            border: none;
            cursor: pointer;
            text-align: center;
            text-decoration: none;
        }
        .btn:hover {
            background-color: #004d00;
        }
        .hidden {
            display: none;
        }
        .btn-back {
            background-color: #d4d4d4;
        }
        .btn-back:hover {
            background-color: #b0b0b0;
        }
        .img-preview {
            max-width: 100%;
            height: auto;
            margin-bottom: 20px;
        }
        .img-container {
            margin-bottom: 20px;
        }
        .expanding-input {
            width: 100%;
            box-sizing: border-box;
            overflow: hidden;
            resize: none;
        }
    </style>
</head>
<body>
    <div class="container" id="mainForm">
        <h1>Reporte de Reclamo de Garantías</h1>
        <form id="warrantyForm">
            <table>
                <tr>
                    <th>Nombre de Concesión</th>
                    <td><textarea class="expanding-input" name="concesion" required></textarea></td>
                    <th>Ubicación</th>
                    <td><textarea class="expanding-input" name="ubicacion" required>DM02 Juarez</textarea></td>
                    <th>Fecha reporte</th>
                    <td><input type="date" name="fecha_reporte" required></td>
                </tr>
                <tr>
                    <th>Orden de trabajo</th>
                    <td><textarea class="expanding-input" name="orden_trabajo" required></textarea></td>
                    <th>DTAC</th>
                    <td><textarea class="expanding-input" name="dtac" required></textarea></td>
                    <th>N.º de Serie</th>
                    <td><textarea class="expanding-input" name="serie" required></textarea></td>
                </tr>
                <tr>
                    <th>Horómetro al fallar</th>
                    <td><textarea class="expanding-input" name="horometro" required></textarea></td>
                </tr>
                <tr>
                    <th>Datos del cliente</th>
                    <th colspan="3">Razon Social: <textarea class="expanding-input" name="razon_social" required>Dimanor</textarea></th>
                </tr>
                <tr>
                    <th>Dirección</th>
                    <td colspan="3"><textarea class="expanding-input" name="direccion" required></textarea></td>
                </tr>
                <tr>
                    <th>Nombre (Cliente)</th>
                    <td colspan="3"><textarea class="expanding-input" name="nombre_cliente" required></textarea></td>
                </tr>
                <tr>
                    <th>Teléfono</th>
                    <td><textarea class="expanding-input" name="telefono" required></textarea></td>
                    <th>Correo</th>
                    <td><textarea class="expanding-input" name="correo" required></textarea></td>
                </tr>
                <tr>
                    <th>Fecha del fallo</th>
                    <td><input type="date" name="fecha_fallo" required></td>
                    <th>Fecha de reparación</th>
                    <td><input type="date" name="fecha_reparacion" required></td>
                </tr>
                <tr>
                    <th>Número de parte de la pieza causante del fallo</th>
                    <td><textarea class="expanding-input" name="pieza_fallo" required></textarea></td>
                    <th>Periodo aproximado de inactividad</th>
                    <td>
                        <select name="inactividad" required>
                            <option value="MENOS DE UN DÍA">MENOS DE UN DÍA</option>
                            <option value="1 A 3 DÍAS">1 A 3 DÍAS</option>
                            <option value="MÁS DE 3 DÍAS">MÁS DE 3 DÍAS</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <th>Número parte de la refacción</th>
                    <td><textarea class="expanding-input" name="parte_refaccion" required></textarea></td>
                    <th>Descripción de la Pieza</th>
                    <td><textarea class="expanding-input" name="descripcion_pieza" required></textarea></td>
                    <th>Requerido</th>
                    <td><textarea class="expanding-input" name="requerido" required></textarea></td>
                </tr>
                <tr>
                    <th>Cantidad</th>
                    <td><input type="number" name="cantidad" required></td>
                </tr>
                <tr>
                    <th colspan="6">SE PUEDE ADJUNTAR COTIZACION PARA CONOSER TODOS LOS NUMERO DE PARTE</th>
                </tr>
                <tr>
                    <th>Usuario técnico</th>
                    <td><textarea class="expanding-input" name="usuario_tecnico" required></textarea></td>
                </tr>
                <tr>
                    <th>Ubicación reparación</th>
                    <td><textarea class="expanding-input" name="ubicacion_reparacion" required></textarea></td>
                </tr>
                <tr>
                    <th>Tipo de M.O.</th>
                    <td><textarea class="expanding-input" name="tipo_mo" required></textarea></td>
                </tr>
                <tr>
                    <th>Requerido</th>
                    <td><textarea class="expanding-input" name="requerido2" required></textarea></td>
                </tr>
                <tr>
                    <th>Cantidad Horas</th>
                    <td><input type="number" name="cantidad_horas" required></td>
                </tr>
                <tr>
                    <th>Queja</th>
                    <td colspan="3"><textarea class="expanding-input" name="queja" required></textarea></td>
                </tr>
                <tr>
                    <th>Causa</th>
                    <td colspan="3"><textarea class="expanding-input" name="causa" required></textarea></td>
                </tr>
                <tr>
                    <th>Corrección</th>
                    <td colspan="3"><textarea class="expanding-input" name="correccion" required></textarea></td>
                </tr>
                <tr>
                    <th colspan="6">SE PUEDE ADJUNTAR REPORTE SIEMPRE Y CUANDO CONTENGA LA QUEJA, CAUSA Y CORRECCION</th>
                </tr>
                <tr>
                    <th colspan="6">FAVOR DE ADJUNTAR EVIDENCIA FOTOGRAFICA DE CADA GARANTIA</th>
                </tr>
                <tr>
                    <th colspan="6">Continuar con el formularió dependiendo del tipo de falla</th>
                </tr>
                <tr>
                    <th colspan="6">Especificaciones (Presiónes / Temperaturas / Tiempos)</th>
                </tr>
                <tr>
                    <th>Descripción</th>
                    <th>Parametros</th>
                    <th>Lectura</th>
                </tr>
                <tr>
                    <td><textarea class="expanding-input" name="descripcion1"></textarea></td>
                    <td><textarea class="expanding-input" name="parametros1"></textarea></td>
                    <td><textarea class="expanding-input" name="lectura1"></textarea></td>
                </tr>
                <tr>
                    <td><textarea class="expanding-input" name="descripcion2"></textarea></td>
                    <td><textarea class="expanding-input" name="parametros2"></textarea></td>
                    <td><textarea class="expanding-input" name="lectura2"></textarea></td>
                </tr>
                <tr>
                    <th colspan="6">Tabla Especificaciones (Electricas)</th>
                </tr>
              <tr>
                    <th>Descripción</th>
                    <th>Parametros</th>
                    <th>Lectura</th>
                </tr>
                <tr>
                    <td><textarea class="expanding-input" name="descripcion1"></textarea></td>
                    <td><textarea class="expanding-input" name="parametros1"></textarea></td>
                    <td><textarea class="expanding-input" name="lectura1"></textarea></td>
                </tr>
                <tr>
                    <td><textarea class="expanding-input" name="descripcion2"></textarea></td>
                    <td><textarea class="expanding-input" name="parametros2"></textarea></td>
                    <td><textarea class="expanding-input" name="lectura2"></textarea></td>
                </tr>
            </table>
            <div>
              <button type="button" class="btn" onclick="saveForm()">Guardar</button>
                        <button type="button" class="btn" onclick="downloadPDF()">Descargar</button>
                        <button type="button" class="btn" onclick="showEvidencePage()">Evidencia</button>
                        <button type="button" class="btn" onclick="showReportPage()">Reporte de Campo</button>
                        <button type="button" class="btn" onclick="resetForm()">Borrar</button>
                        <button type="button" onclick="window.location.href='main.html'">Regresar</button>
            </div>
        </form>

    </div>
    <script>
        document.querySelectorAll('.expanding-input').forEach(function(element) {
            element.style.height = (element.scrollHeight) + 'px';
            element.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = (this.scrollHeight) + 'px';
                // Adjust the container height to fit the expanding content
                document.getElementById('mainForm').style.height = 'auto';
            });
        });
    </script>
          </form>
      </div>

      <div class="container hidden" id="evidencePage">
          <h2>Evidencia de la Garantía</h2>
          <form id="evidenceForm">
              <div class="img-container">
                  <label>Imagen 1</label>
                  <input type="file" accept="image/*" onchange="previewImage(event, 'preview1')">
                  <img id="preview1" class="img-preview">
              </div>
              <div class="img-container">
                  <label>Imagen 2</label>
                  <input type="file" accept="image/*" onchange="previewImage(event, 'preview2')">
                  <img id="preview2" class="img-preview">
              </div>
              <div class="img-container">
                  <label>Imagen 3</label>
                  <input type="file" accept="image/*" onchange="previewImage(event, 'preview3')">
                  <img id="preview3" class="img-preview">
              </div>
              <div class="img-container">
                  <label>Imagen 4</label>
                  <input type="file" accept="image/*" onchange="previewImage(event, 'preview4')">
                  <img id="preview4" class="img-preview">
              </div>
              <button type="button" class="btn-back" onclick="goBack()">Regresar</button>
              <button type="button" class="btn" onclick="downloadPDF()">Descargar</button>
          </form>
      </div>

      <div class="container hidden" id="reportPage">
          <h2>Reporte de Campo</h2>
          <form id="reportForm">
              <div class="img-container">
                  <label>Imagen Grande</label>
                  <input type="file" accept="image/*" onchange="previewImage(event, 'largeImagePreview')">
                  <img id="largeImagePreview" class="img-preview">
              </div>
              <button type="button" class="btn-back" onclick="goBack()">Regresar</button>
              <button type="button" class="btn" onclick="downloadPDF()">Descargar</button>
          </form>
      </div>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
      <script>
          function saveForm() {
              downloadPDF();
              alert("Formulario guardado y descargado!");
          }

          function goBack() {
              document.getElementById('evidencePage').classList.add('hidden');
              document.getElementById('reportPage').classList.add('hidden');
              document.getElementById('mainForm').classList.remove('hidden');
          }

          function downloadPDF() {
              const element = document.querySelector('.container:not(.hidden)');
              const opt = {
                  margin: 1,
                  filename: 'reporte_garantia.pdf',
                  image: { type: 'jpeg', quality: 0.98 },
                  html2canvas: { scale: 2 },
                  jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
              };
              html2pdf().from(element).set(opt).save();
          }

          function showEvidencePage() {
              document.getElementById('mainForm').classList.add('hidden');
              document.getElementById('evidencePage').classList.remove('hidden');
          }

          function resetForm() {
              document.getElementById("warrantyForm").reset();
          }

          function showReportPage() {
              document.getElementById('mainForm').classList.add('hidden');
              document.getElementById('reportPage').classList.remove('hidden');
          }

          function previewImage(event, previewId) {
              const reader = new FileReader();
              reader.onload = function () {
                  const output = document.getElementById(previewId);
                  output.src = reader.result;
                  output.style.display = 'block';
              };
              reader.readAsDataURL(event.target.files[0]);
          }
      </script>
  </body>
  </html>
